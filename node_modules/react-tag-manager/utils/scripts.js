'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var loadScript = exports.loadScript = function loadScript(_ref, dataLayerName, loadCallback) {
  var id = _ref.id,
      auth = _ref.auth,
      preview = _ref.preview;

  var script = document.createElement('SCRIPT');

  var src = 'https://www.googletagmanager.com/gtm.js?id=' + id;
  if (auth) {
    src += '&gtm_auth=' + auth;
  }

  if (preview) {
    src += '&gtm_preview=' + preview;
  }

  script.async = true;
  script.src = src;

  script.onload = function () {
    window[dataLayerName].push({ 'gtm.start': new Date().getTime(), event: 'gtm.js' });

    loadCallback();
  };

  script.onerror = function () {
    throw new Error('Google Tag Manager could not be loaded.');
  };

  document.head.appendChild(script);
};

var loadNoScript = exports.loadNoScript = function loadNoScript(gtmID) {
  document.body.appendChild('<iframe src="//www.googletagmanager.com/ns.html?id=' + gtmID + '"\n        height="0" width="0" style="display:none;visibility:hidden" id="tag-manager"></iframe>');
};

exports.default = function (gtm, dataLayerName, loadCallback) {
  loadScript(gtm, dataLayerName, loadCallback);
};